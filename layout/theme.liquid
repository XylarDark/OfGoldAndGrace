<!doctype html>
<html lang="{{ shop.locale }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="{{ settings.color_primary }}">
  <meta name="format-detection" content="telephone=no">

  <!-- Performance: Resource hints -->
  <link rel="preconnect" href="https://www.google-analytics.com">
  <link rel="preconnect" href="https://www.googletagmanager.com">

  <title>{{ page_title }}</title>

  {% if page_description %}
    <meta name="description" content="{{ page_description }}">
  {% endif %}

  <link rel="canonical" href="{{ canonical_url }}">

  <!-- Performance: Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="dns-prefetch" href="//www.google-analytics.com">

  <!-- Performance: Preload critical fonts if any -->
  <!-- <link rel="preload" href="{{ 'font-file.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin> -->

  <!-- Accessibility styles -->
  {{ 'a11y.css' | asset_url | stylesheet_tag }}

  <!-- Structured Data for SEO -->
  {% render 'structured-data' %}

  {% if settings.ga4_measurement_id != blank %}
  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ settings.ga4_measurement_id }}"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ settings.ga4_measurement_id }}');
  </script>
  {% endif %}

  {{ content_for_header }}
</head>

<body class="gradient">
  <!-- Skip Links -->
  <a href="#MainContent" class="skip-link">{{ 'accessibility.skip_to_content' | t }}</a>
  <a href="#site-nav" class="skip-link sr-only" data-skip-target="site-nav">{{ 'accessibility.skip_to_navigation' | t }}</a>
  <a href="#site-search" class="skip-link sr-only" data-skip-target="site-search">{{ 'accessibility.skip_to_search' | t }}</a>
  <a href="#site-footer" class="skip-link sr-only" data-skip-target="site-footer">{{ 'accessibility.skip_to_footer' | t }}</a>

  {% section 'header' %}

  <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
    {{ content_for_layout }}
  </main>

  {% section 'footer' %}

  <!-- Quick View Modal -->
  {% render 'quick-view-modal' %}

  <script>
    // Basic theme JavaScript
    document.documentElement.className = document.documentElement.className.replace('no-js', 'js');

    // Accessibility: Show skip links only when target elements exist
    document.addEventListener('DOMContentLoaded', function() {
      const skipLinks = document.querySelectorAll('[data-skip-target]');
      skipLinks.forEach(link => {
        const targetId = link.getAttribute('data-skip-target');
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
          link.classList.remove('sr-only');
        }
      });
    });
  </script>

  <!-- Performance utilities - loaded early -->
  <script defer src="{{ 'performance.js' | asset_url }}"></script>

  <!-- Theme enhancements - loaded after core content for performance -->
  <script defer src="{{ 'focus-trap.js' | asset_url }}"></script>
  <script defer src="{{ 'lazyload.js' | asset_url }}"></script>
  <script defer src="{{ 'reviews.js' | asset_url }}"></script>
  <script defer src="{{ 'quick-view.js' | asset_url }}"></script>
  <script defer src="{{ 'wishlist.js' | asset_url }}"></script>
</body>
</html>
